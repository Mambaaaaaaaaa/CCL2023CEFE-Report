# 赛道1 代码说明

本项目提供我们小队在 2023CCL 中小学作文流畅度评价（CEFE）任务中，赛道1所用到的关键数据与代码，接下来，从数据构造、训练、预测三个方面进行说明。

## 数据构造

由于大赛提供数据较为有限，且再次标注成本较高。我们决定使用伪数据构造的方法，进行训练数据的生成。

我们利用公开的数据和我们从中提取出的重要成分，如混淆集等，作为伪数据构造的原始数据。这些原始数据保存在 ```source_data``` 目录下。其中，原始数据主要收集自 Lang8 数据集，当然，在实际使用的时候，也可以换成其他合适的数据集。

利用这些数据，我们依据每个细粒度错误类别进行伪数据的构造（其中其他成分多余与语序不当的错误，由于进行伪数据构造的难度较大，且效果并不好。于是，对于这两个类别，我们直接选用公开的真实数据）。相关代码都保存在 ```gen_data``` 目录下，最终生成的伪数据保存在 ```gen_data/data``` 目录下。

进行伪数据构造时，直接运行相应的 python 程序即可。以缺字漏字为例，其是第一个类别。

    python gen_data/gen_1.py

得到每个子类别的伪数据后，我们按子类别划分训练、验证与测试集（这里，测试集也可以使用大赛提供的含有 gold 的数据）。并将所有数据混合在一起，作为最终的训练、验证、测试集。相应的实现代码是 ```gen_data/data/merge.py``` 。

## 训练

有了相应的训练数据，我们开始进行模型的训练。我们使用的 ELECTRA 模型，具体基座模型是 ```chinese-electra-180g-base-discriminator``` 。训练部分的代码是 ```main.py``` ，最终训练得到的模型保存在 ```output``` 中。

其中，在训练过程中，使用的超参数如下：

```python
train_path = './gen_data/train.json'
val_path = './gen_data/val.json'
test_path = './gen_data/val.json'

checkpoint_dir = './output/checkpoint.tar'
max_seq_length = 128
LR = 5e-5
batch_size = 32
num_epochs = 50
set_seed = 1
TEST = False
```

## 预测

有了训好的模型，我们可以利用他们进行结果的预测。由于，我们依据粗粒度错误类别训练了4个模型，采用集成的方法得到最终的结果。我们通过 ```predict.py``` 完成相应粗粒度错误对应细粒度错误类别的预测（注意根据粗粒度错误类别选择相应的模型），最后，用 ```merge.py``` 完成结果的集成。
